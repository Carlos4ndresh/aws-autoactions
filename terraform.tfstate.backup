{
  "version": 4,
  "terraform_version": "0.12.6",
  "serial": 119,
  "lineage": "21427be2-7d34-65b4-789f-ee069139e9af",
  "outputs": {
    "ec2_reaper": {
      "value": "{$EC2Janitor.arn}",
      "type": "string"
    }
  },
  "resources": [
    {
      "mode": "data",
      "type": "aws_caller_identity",
      "name": "current",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "account_id": "762537114155",
            "arn": "arn:aws:iam::762537114155:user/cherrera",
            "id": "2019-08-15 20:05:11.381262 +0000 UTC",
            "user_id": "AIDA3DCWA7IV2TE5ACHOK"
          }
        }
      ]
    },
    {
      "mode": "data",
      "type": "template_file",
      "name": "iam_lambda_notify",
      "provider": "provider.template",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "c80798d36463c6ebead7f02ae82a74f1d12bcbf7f5667be2964d9fe3247c5699",
            "rendered": "{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                        \"logs:CreateLogGroup\",\n                        \"logs:CreateLogStream\",\n                        \"logs:PutLogEvents\"\n                      ],\n            \"Resource\": \"arn:aws:logs:us-west-2:762537114155:*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"lambda:InvokeFunction\",\n                \"ses:SendEmail\",\n                \"ses:SendRawEmail\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}",
            "template": "{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                        \"logs:CreateLogGroup\",\n                        \"logs:CreateLogStream\",\n                        \"logs:PutLogEvents\"\n                      ],\n            \"Resource\": \"arn:aws:logs:${region}:${account_id}:*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"lambda:InvokeFunction\",\n                \"ses:SendEmail\",\n                \"ses:SendRawEmail\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}",
            "vars": {
              "account_id": "762537114155",
              "region": "us-west-2"
            }
          },
          "depends_on": [
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "data",
      "type": "template_file",
      "name": "iam_lambda_read_instances",
      "provider": "provider.template",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "7257c7a04da267a308a906c34d6ac9fd2befe5c268875f47d39f72354918f9b3",
            "rendered": "{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": \"logs:CreateLogGroup\",\n            \"Resource\": \"arn:aws:logs:us-west-2:762537114155:*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"logs:CreateLogStream\",\n                \"logs:PutLogEvents\"\n            ],\n            \"Resource\": [\n                \"arn:aws:logs:us-west-2:762537114155:*\"\n            ]\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": \"ec2:Describe*\",\n            \"Resource\": \"*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": \"elasticloadbalancing:Describe*\",\n            \"Resource\": \"*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"cloudwatch:ListMetrics\",\n                \"cloudwatch:GetMetricStatistics\",\n                \"cloudwatch:Describe*\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": \"autoscaling:Describe*\",\n            \"Resource\": \"*\"\n        }\n    ]\n}",
            "template": "{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": \"logs:CreateLogGroup\",\n            \"Resource\": \"arn:aws:logs:${region}:${account_id}:*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"logs:CreateLogStream\",\n                \"logs:PutLogEvents\"\n            ],\n            \"Resource\": [\n                \"arn:aws:logs:${region}:${account_id}:*\"\n            ]\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": \"ec2:Describe*\",\n            \"Resource\": \"*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": \"elasticloadbalancing:Describe*\",\n            \"Resource\": \"*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"cloudwatch:ListMetrics\",\n                \"cloudwatch:GetMetricStatistics\",\n                \"cloudwatch:Describe*\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": \"autoscaling:Describe*\",\n            \"Resource\": \"*\"\n        }\n    ]\n}",
            "vars": {
              "account_id": "762537114155",
              "region": "us-west-2"
            }
          },
          "depends_on": [
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "data",
      "type": "template_file",
      "name": "iam_lambda_stop_and_terminate_instances",
      "provider": "provider.template",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "9d81430c3d0353c2c76047d1f868cb6a65e3a952a177e151630045716e91b3c7",
            "rendered": "{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": \"logs:CreateLogGroup\",\n            \"Resource\": \"arn:aws:logs:us-west-2:762537114155:*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"logs:CreateLogStream\",\n                \"logs:PutLogEvents\"\n            ],\n            \"Resource\": [\n                \"arn:aws:logs:us-west-2:762537114155:*\"\n            ]\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"lambda:InvokeFunction\",\n                \"ses:SendEmail\",\n                \"ses:SendRawEmail\",\n                \"ec2:*\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}",
            "template": "{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": \"logs:CreateLogGroup\",\n            \"Resource\": \"arn:aws:logs:${region}:${account_id}:*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"logs:CreateLogStream\",\n                \"logs:PutLogEvents\"\n            ],\n            \"Resource\": [\n                \"arn:aws:logs:${region}:${account_id}:*\"\n            ]\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"lambda:InvokeFunction\",\n                \"ses:SendEmail\",\n                \"ses:SendRawEmail\",\n                \"ec2:*\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}",
            "vars": {
              "account_id": "762537114155",
              "region": "us-west-2"
            }
          },
          "depends_on": [
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "data",
      "type": "template_file",
      "name": "iam_lambda_terminate_asgs",
      "provider": "provider.template",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "5e9c1754f587e88c9a49d1434ab02c59e31ea0b15d2f92534de44d2bf397bc0f",
            "rendered": "{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": \"logs:CreateLogGroup\",\n            \"Resource\": \"arn:aws:logs:us-west-2:762537114155:*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"logs:CreateLogStream\",\n                \"logs:PutLogEvents\"\n            ],\n            \"Resource\": [\n                \"arn:aws:logs:us-west-2:762537114155:*\"\n            ]\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"lambda:InvokeFunction\",\n                \"ses:SendEmail\",\n                \"ses:SendRawEmail\",\n                \"autoscaling:*\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}",
            "template": "{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": \"logs:CreateLogGroup\",\n            \"Resource\": \"arn:aws:logs:${region}:${account_id}:*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"logs:CreateLogStream\",\n                \"logs:PutLogEvents\"\n            ],\n            \"Resource\": [\n                \"arn:aws:logs:${region}:${account_id}:*\"\n            ]\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"lambda:InvokeFunction\",\n                \"ses:SendEmail\",\n                \"ses:SendRawEmail\",\n                \"autoscaling:*\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}",
            "vars": {
              "account_id": "762537114155",
              "region": "us-west-2"
            }
          },
          "depends_on": [
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudwatch_event_rule",
      "name": "check_asg_ttls",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:events:us-west-2:762537114155:rule/check_asg_ttls",
            "description": "Check ASG TTLs to see if they are expired",
            "event_pattern": null,
            "id": "check_asg_ttls",
            "is_enabled": true,
            "name": "check_asg_ttls",
            "name_prefix": null,
            "role_arn": "",
            "schedule_expression": "cron(0 * * * ? *)",
            "tags": null
          },
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudwatch_event_rule",
      "name": "check_instance_ttls",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:events:us-west-2:762537114155:rule/check_instance_ttls",
            "description": "Check instance TTLs to see if they are expired",
            "event_pattern": null,
            "id": "check_instance_ttls",
            "is_enabled": true,
            "name": "check_instance_ttls",
            "name_prefix": null,
            "role_arn": "",
            "schedule_expression": "cron(0 * * * ? *)",
            "tags": null
          },
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudwatch_event_rule",
      "name": "clean_untagged_asgs",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:events:us-west-2:762537114155:rule/clean_untagged_asgs",
            "description": "Check untagged asgs and delete old ones",
            "event_pattern": null,
            "id": "clean_untagged_asgs",
            "is_enabled": true,
            "name": "clean_untagged_asgs",
            "name_prefix": null,
            "role_arn": "",
            "schedule_expression": "cron(0 8 * * ? *)",
            "tags": null
          },
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudwatch_event_rule",
      "name": "clean_untagged_instances",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:events:us-west-2:762537114155:rule/clean_untagged_instances",
            "description": "Check untagged instances and stop/terminate old ones",
            "event_pattern": null,
            "id": "clean_untagged_instances",
            "is_enabled": true,
            "name": "clean_untagged_instances",
            "name_prefix": null,
            "role_arn": "",
            "schedule_expression": "cron(0 8 * * ? *)",
            "tags": null
          },
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudwatch_event_rule",
      "name": "notify_running_instances",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:events:us-west-2:762537114155:rule/notify_running_instances",
            "description": "Notify users about their running AWS instances",
            "event_pattern": null,
            "id": "notify_running_instances",
            "is_enabled": true,
            "name": "notify_running_instances",
            "name_prefix": null,
            "role_arn": "",
            "schedule_expression": "cron(0 8 * * ? *)",
            "tags": null
          },
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudwatch_event_rule",
      "name": "notify_untagged_instances",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:events:us-west-2:762537114155:rule/notify_untagged_instances",
            "description": "Notify users about their untagged AWS instances",
            "event_pattern": null,
            "id": "notify_untagged_instances",
            "is_enabled": true,
            "name": "notify_untagged_instances",
            "name_prefix": null,
            "role_arn": "",
            "schedule_expression": "cron(0 6 * * ? *)",
            "tags": null
          },
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudwatch_event_target",
      "name": "asg_reaper_report",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lambda:us-west-2:762537114155:function:ASGReaper",
            "batch_target": [],
            "ecs_target": [],
            "id": "check_asg_ttls-ASGReaper",
            "input": "",
            "input_path": "",
            "input_transformer": [],
            "kinesis_target": [],
            "role_arn": "",
            "rule": "check_asg_ttls",
            "run_command_targets": [],
            "sqs_target": [],
            "target_id": "ASGReaper"
          },
          "private": "bnVsbA==",
          "depends_on": [
            "aws_cloudwatch_event_rule.check_asg_ttls",
            "aws_lambda_function.ASGReaper"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudwatch_event_target",
      "name": "daily_running_report",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lambda:us-west-2:762537114155:function:notifyInstanceUsage",
            "batch_target": [],
            "ecs_target": [],
            "id": "notify_running_instances-notifyInstanceUsage",
            "input": "",
            "input_path": "",
            "input_transformer": [],
            "kinesis_target": [],
            "role_arn": "",
            "rule": "notify_running_instances",
            "run_command_targets": [],
            "sqs_target": [],
            "target_id": "notifyInstanceUsage"
          },
          "private": "bnVsbA==",
          "depends_on": [
            "aws_cloudwatch_event_rule.notify_running_instances",
            "aws_lambda_function.notifyInstanceUsage"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudwatch_event_target",
      "name": "daily_untagged_report",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lambda:us-west-2:762537114155:function:notifyUntaggedInstances",
            "batch_target": [],
            "ecs_target": [],
            "id": "notify_untagged_instances-notifyUntaggedInstances",
            "input": "",
            "input_path": "",
            "input_transformer": [],
            "kinesis_target": [],
            "role_arn": "",
            "rule": "notify_untagged_instances",
            "run_command_targets": [],
            "sqs_target": [],
            "target_id": "notifyUntaggedInstances"
          },
          "private": "bnVsbA==",
          "depends_on": [
            "aws_cloudwatch_event_rule.notify_untagged_instances",
            "aws_lambda_function.notifyUntaggedInstances"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudwatch_event_target",
      "name": "reaper_report",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lambda:us-west-2:762537114155:function:EC2Reaper",
            "batch_target": [],
            "ecs_target": [],
            "id": "check_instance_ttls-EC2Reaper",
            "input": "",
            "input_path": "",
            "input_transformer": [],
            "kinesis_target": [],
            "role_arn": "",
            "rule": "check_instance_ttls",
            "run_command_targets": [],
            "sqs_target": [],
            "target_id": "EC2Reaper"
          },
          "private": "bnVsbA==",
          "depends_on": [
            "aws_cloudwatch_event_rule.check_instance_ttls",
            "aws_lambda_function.EC2Reaper"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudwatch_event_target",
      "name": "untagged_asg_cleanup",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lambda:us-west-2:762537114155:function:ASGJanitor",
            "batch_target": [],
            "ecs_target": [],
            "id": "clean_untagged_asgs-ASGJanitor",
            "input": "",
            "input_path": "",
            "input_transformer": [],
            "kinesis_target": [],
            "role_arn": "",
            "rule": "clean_untagged_asgs",
            "run_command_targets": [],
            "sqs_target": [],
            "target_id": "ASGJanitor"
          },
          "private": "bnVsbA==",
          "depends_on": [
            "aws_cloudwatch_event_rule.clean_untagged_asgs",
            "aws_lambda_function.ASGJanitor"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudwatch_event_target",
      "name": "untagged_instance_cleanup",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lambda:us-west-2:762537114155:function:EC2Janitor",
            "batch_target": [],
            "ecs_target": [],
            "id": "clean_untagged_instances-EC2Janitor",
            "input": "",
            "input_path": "",
            "input_transformer": [],
            "kinesis_target": [],
            "role_arn": "",
            "rule": "clean_untagged_instances",
            "run_command_targets": [],
            "sqs_target": [],
            "target_id": "EC2Janitor"
          },
          "private": "bnVsbA==",
          "depends_on": [
            "aws_cloudwatch_event_rule.clean_untagged_instances",
            "aws_lambda_function.EC2Janitor"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "lambda_notify",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::762537114155:role/lambda_notify",
            "assume_role_policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}",
            "create_date": "2019-08-15T20:05:20Z",
            "description": "",
            "force_detach_policies": false,
            "id": "lambda_notify",
            "max_session_duration": 3600,
            "name": "lambda_notify",
            "name_prefix": null,
            "path": "/",
            "permissions_boundary": null,
            "tags": null,
            "unique_id": "AROA3DCWA7IVV3LOQLJD5"
          },
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "lambda_read_instances",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::762537114155:role/lambda_read_instances",
            "assume_role_policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}",
            "create_date": "2019-08-15T20:05:20Z",
            "description": "",
            "force_detach_policies": false,
            "id": "lambda_read_instances",
            "max_session_duration": 3600,
            "name": "lambda_read_instances",
            "name_prefix": null,
            "path": "/",
            "permissions_boundary": null,
            "tags": null,
            "unique_id": "AROA3DCWA7IVUJQDWAIA7"
          },
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "lambda_stop_and_terminate_instances",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::762537114155:role/lambda_stop_and_terminate_instances",
            "assume_role_policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}",
            "create_date": "2019-08-15T20:05:20Z",
            "description": "",
            "force_detach_policies": false,
            "id": "lambda_stop_and_terminate_instances",
            "max_session_duration": 3600,
            "name": "lambda_stop_and_terminate_instances",
            "name_prefix": null,
            "path": "/",
            "permissions_boundary": null,
            "tags": null,
            "unique_id": "AROA3DCWA7IVVHPYEJUEG"
          },
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "lambda_terminate_asgs",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::762537114155:role/lambda_terminate_asgs",
            "assume_role_policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}",
            "create_date": "2019-08-15T20:05:20Z",
            "description": "",
            "force_detach_policies": false,
            "id": "lambda_terminate_asgs",
            "max_session_duration": 3600,
            "name": "lambda_terminate_asgs",
            "name_prefix": null,
            "path": "/",
            "permissions_boundary": null,
            "tags": null,
            "unique_id": "AROA3DCWA7IVTYGCESJNY"
          },
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy",
      "name": "lambda_notify_policy",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "lambda_notify:lambda_notify_policy",
            "name": "lambda_notify_policy",
            "name_prefix": null,
            "policy": "{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                        \"logs:CreateLogGroup\",\n                        \"logs:CreateLogStream\",\n                        \"logs:PutLogEvents\"\n                      ],\n            \"Resource\": \"arn:aws:logs:us-west-2:762537114155:*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"lambda:InvokeFunction\",\n                \"ses:SendEmail\",\n                \"ses:SendRawEmail\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}",
            "role": "lambda_notify"
          },
          "private": "bnVsbA==",
          "depends_on": [
            "aws_iam_role.lambda_notify",
            "data.template_file.iam_lambda_notify"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy",
      "name": "lambda_read_instances_policy",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "lambda_read_instances:lambda_read_instances_policy",
            "name": "lambda_read_instances_policy",
            "name_prefix": null,
            "policy": "{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": \"logs:CreateLogGroup\",\n            \"Resource\": \"arn:aws:logs:us-west-2:762537114155:*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"logs:CreateLogStream\",\n                \"logs:PutLogEvents\"\n            ],\n            \"Resource\": [\n                \"arn:aws:logs:us-west-2:762537114155:*\"\n            ]\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": \"ec2:Describe*\",\n            \"Resource\": \"*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": \"elasticloadbalancing:Describe*\",\n            \"Resource\": \"*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"cloudwatch:ListMetrics\",\n                \"cloudwatch:GetMetricStatistics\",\n                \"cloudwatch:Describe*\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": \"autoscaling:Describe*\",\n            \"Resource\": \"*\"\n        }\n    ]\n}",
            "role": "lambda_read_instances"
          },
          "private": "bnVsbA==",
          "depends_on": [
            "aws_iam_role.lambda_read_instances",
            "data.template_file.iam_lambda_read_instances"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy",
      "name": "lambda_stop_and_terminate_instances",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "lambda_stop_and_terminate_instances:lambda_stop_and_terminate_instances",
            "name": "lambda_stop_and_terminate_instances",
            "name_prefix": null,
            "policy": "{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": \"logs:CreateLogGroup\",\n            \"Resource\": \"arn:aws:logs:us-west-2:762537114155:*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"logs:CreateLogStream\",\n                \"logs:PutLogEvents\"\n            ],\n            \"Resource\": [\n                \"arn:aws:logs:us-west-2:762537114155:*\"\n            ]\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"lambda:InvokeFunction\",\n                \"ses:SendEmail\",\n                \"ses:SendRawEmail\",\n                \"ec2:*\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}",
            "role": "lambda_stop_and_terminate_instances"
          },
          "private": "bnVsbA==",
          "depends_on": [
            "aws_iam_role.lambda_stop_and_terminate_instances",
            "data.template_file.iam_lambda_stop_and_terminate_instances"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy",
      "name": "lambda_terminate_asgs",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "lambda_terminate_asgs:lambda_terminate_asgs",
            "name": "lambda_terminate_asgs",
            "name_prefix": null,
            "policy": "{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": \"logs:CreateLogGroup\",\n            \"Resource\": \"arn:aws:logs:us-west-2:762537114155:*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"logs:CreateLogStream\",\n                \"logs:PutLogEvents\"\n            ],\n            \"Resource\": [\n                \"arn:aws:logs:us-west-2:762537114155:*\"\n            ]\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"lambda:InvokeFunction\",\n                \"ses:SendEmail\",\n                \"ses:SendRawEmail\",\n                \"autoscaling:*\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}",
            "role": "lambda_terminate_asgs"
          },
          "private": "bnVsbA==",
          "depends_on": [
            "aws_iam_role.lambda_terminate_asgs",
            "data.template_file.iam_lambda_terminate_asgs"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "ASGJanitor",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lambda:us-west-2:762537114155:function:ASGJanitor",
            "dead_letter_config": [],
            "description": "Terminates untagged ASGs after a pre-set number of days.",
            "environment": [
              {
                "variables": {
                  "asgReapDays": "1",
                  "isActive": "True",
                  "slackChannel": "#aws-test",
                  "slackHookUrl": "https://hooks.slack.com/services/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"
                }
              }
            ],
            "filename": "./files/ASGJanitor.zip",
            "function_name": "ASGJanitor",
            "handler": "ASGJanitor.lambda_handler",
            "id": "ASGJanitor",
            "invoke_arn": "arn:aws:apigateway:us-west-2:lambda:path/2015-03-31/functions/arn:aws:lambda:us-west-2:762537114155:function:ASGJanitor/invocations",
            "kms_key_arn": "",
            "last_modified": "2019-08-15T20:05:37.411+0000",
            "layers": null,
            "memory_size": 128,
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-west-2:762537114155:function:ASGJanitor:$LATEST",
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::762537114155:role/lambda_terminate_asgs",
            "runtime": "python3.6",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "source_code_hash": "1tJFsReUyY3MHCfc0cgm/0QGFBjlI9oUfDLhnTpyF3c=",
            "source_code_size": 2962,
            "tags": null,
            "timeout": 120,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9fQ==",
          "depends_on": [
            "aws_iam_role.lambda_terminate_asgs"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "ASGReaper",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lambda:us-west-2:762537114155:function:ASGReaper",
            "dead_letter_config": [],
            "description": "Checks ASG TTLs for expiration and deals with them accordingly.",
            "environment": [
              {
                "variables": {
                  "isActive": "True",
                  "slackChannel": "#aws-test",
                  "slackHookUrl": "https://hooks.slack.com/services/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"
                }
              }
            ],
            "filename": "./files/ASGReaper.zip",
            "function_name": "ASGReaper",
            "handler": "ASGReaper.lambda_handler",
            "id": "ASGReaper",
            "invoke_arn": "arn:aws:apigateway:us-west-2:lambda:path/2015-03-31/functions/arn:aws:lambda:us-west-2:762537114155:function:ASGReaper/invocations",
            "kms_key_arn": "",
            "last_modified": "2019-08-15T20:05:39.337+0000",
            "layers": null,
            "memory_size": 128,
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-west-2:762537114155:function:ASGReaper:$LATEST",
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::762537114155:role/lambda_terminate_asgs",
            "runtime": "python3.6",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "source_code_hash": "wO7r+c5et5ut/L8+ZoFNmVtdmo5RmBcJ9Qk+CYPGMmQ=",
            "source_code_size": 3052,
            "tags": null,
            "timeout": 120,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9fQ==",
          "depends_on": [
            "aws_iam_role.lambda_terminate_asgs"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "EC2Janitor",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lambda:us-west-2:762537114155:function:EC2Janitor",
            "dead_letter_config": [],
            "description": "Stops or terminates untagged instances after a pre-set number of days.",
            "environment": [
              {
                "variables": {
                  "isActive": "True",
                  "reapDays": "1",
                  "slackChannel": "#aws-test",
                  "slackHookUrl": "https://hooks.slack.com/services/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",
                  "sleepDays": "1"
                }
              }
            ],
            "filename": "./files/EC2Janitor.zip",
            "function_name": "EC2Janitor",
            "handler": "EC2Janitor.lambda_handler",
            "id": "EC2Janitor",
            "invoke_arn": "arn:aws:apigateway:us-west-2:lambda:path/2015-03-31/functions/arn:aws:lambda:us-west-2:762537114155:function:EC2Janitor/invocations",
            "kms_key_arn": "",
            "last_modified": "2019-08-15T20:05:56.077+0000",
            "layers": null,
            "memory_size": 128,
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-west-2:762537114155:function:EC2Janitor:$LATEST",
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::762537114155:role/lambda_stop_and_terminate_instances",
            "runtime": "python3.6",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "source_code_hash": "3xzqZ4diySQCtCZkosWos7aWgH9hapBMdzllolv7HN8=",
            "source_code_size": 3194,
            "tags": null,
            "timeout": 120,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9fQ==",
          "depends_on": [
            "aws_iam_role.lambda_stop_and_terminate_instances"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "EC2Reaper",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lambda:us-west-2:762537114155:function:EC2Reaper",
            "dead_letter_config": [],
            "description": "Checks instance TTLs for expiration and deals with them accordingly.",
            "environment": [
              {
                "variables": {
                  "isActive": "True",
                  "slackChannel": "#aws-test",
                  "slackHookUrl": "https://hooks.slack.com/services/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"
                }
              }
            ],
            "filename": "./files/EC2Reaper.zip",
            "function_name": "EC2Reaper",
            "handler": "EC2Reaper.lambda_handler",
            "id": "EC2Reaper",
            "invoke_arn": "arn:aws:apigateway:us-west-2:lambda:path/2015-03-31/functions/arn:aws:lambda:us-west-2:762537114155:function:EC2Reaper/invocations",
            "kms_key_arn": "",
            "last_modified": "2019-08-15T20:05:53.553+0000",
            "layers": null,
            "memory_size": 128,
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-west-2:762537114155:function:EC2Reaper:$LATEST",
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::762537114155:role/lambda_stop_and_terminate_instances",
            "runtime": "python3.6",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "source_code_hash": "C0Q6NV+J8N9i+zKKdZEamAg3yZmn3d5nWCFfNEjWAYY=",
            "source_code_size": 2984,
            "tags": null,
            "timeout": 120,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9fQ==",
          "depends_on": [
            "aws_iam_role.lambda_stop_and_terminate_instances"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "getRunningInstances",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lambda:us-west-2:762537114155:function:getRunningInstances",
            "dead_letter_config": [],
            "description": "Gathers a list of running instances.",
            "environment": [],
            "filename": "./files/getRunningInstances.zip",
            "function_name": "getRunningInstances",
            "handler": "getRunningInstances.lambda_handler",
            "id": "getRunningInstances",
            "invoke_arn": "arn:aws:apigateway:us-west-2:lambda:path/2015-03-31/functions/arn:aws:lambda:us-west-2:762537114155:function:getRunningInstances/invocations",
            "kms_key_arn": "",
            "last_modified": "2019-08-15T20:05:46.418+0000",
            "layers": null,
            "memory_size": 128,
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-west-2:762537114155:function:getRunningInstances:$LATEST",
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::762537114155:role/lambda_read_instances",
            "runtime": "python3.6",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "source_code_hash": "xiMAerfanrizRnVmS/+2Y/YlCImD81yHVIqEcz/Ct1Q=",
            "source_code_size": 1188,
            "tags": null,
            "timeout": 120,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9fQ==",
          "depends_on": [
            "aws_iam_role.lambda_read_instances"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "getTaggedASGs",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lambda:us-west-2:762537114155:function:getTaggedASGs",
            "dead_letter_config": [],
            "description": "Gathers a list of correctly tagged instances.",
            "environment": [
              {
                "variables": {
                  "REQTAGS": "TTL,owner"
                }
              }
            ],
            "filename": "./files/getTaggedASGs.zip",
            "function_name": "getTaggedASGs",
            "handler": "getTaggedASGs.lambda_handler",
            "id": "getTaggedASGs",
            "invoke_arn": "arn:aws:apigateway:us-west-2:lambda:path/2015-03-31/functions/arn:aws:lambda:us-west-2:762537114155:function:getTaggedASGs/invocations",
            "kms_key_arn": "",
            "last_modified": "2019-08-15T20:05:48.835+0000",
            "layers": null,
            "memory_size": 128,
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-west-2:762537114155:function:getTaggedASGs:$LATEST",
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::762537114155:role/lambda_read_instances",
            "runtime": "python3.6",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "source_code_hash": "wQYzi3fld1ISjkbPhyBeycN+yyMdQnzCznIi0z7jy44=",
            "source_code_size": 1418,
            "tags": null,
            "timeout": 120,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9fQ==",
          "depends_on": [
            "aws_iam_role.lambda_read_instances"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "getTaggedInstances",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lambda:us-west-2:762537114155:function:getTaggedInstances",
            "dead_letter_config": [],
            "description": "Gathers a list of correctly tagged instances.",
            "environment": [
              {
                "variables": {
                  "REQTAGS": "TTL,owner"
                }
              }
            ],
            "filename": "./files/getTaggedInstances.zip",
            "function_name": "getTaggedInstances",
            "handler": "getTaggedInstances.lambda_handler",
            "id": "getTaggedInstances",
            "invoke_arn": "arn:aws:apigateway:us-west-2:lambda:path/2015-03-31/functions/arn:aws:lambda:us-west-2:762537114155:function:getTaggedInstances/invocations",
            "kms_key_arn": "",
            "last_modified": "2019-08-15T20:05:44.185+0000",
            "layers": null,
            "memory_size": 128,
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-west-2:762537114155:function:getTaggedInstances:$LATEST",
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::762537114155:role/lambda_read_instances",
            "runtime": "python3.6",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "source_code_hash": "r3uBz+xw6eIvQ5HpLIlJxKIrTZjGHCp16JNMirOfoH8=",
            "source_code_size": 1484,
            "tags": null,
            "timeout": 120,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9fQ==",
          "depends_on": [
            "aws_iam_role.lambda_read_instances"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "getUntaggedASGs",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lambda:us-west-2:762537114155:function:getUntaggedASGs",
            "dead_letter_config": [],
            "description": "Gathers a list of untagged or improperly tagged instances.",
            "environment": [
              {
                "variables": {
                  "REQTAGS": "TTL,owner"
                }
              }
            ],
            "filename": "./files/getUntaggedASGs.zip",
            "function_name": "getUntaggedASGs",
            "handler": "getUntaggedASGs.lambda_handler",
            "id": "getUntaggedASGs",
            "invoke_arn": "arn:aws:apigateway:us-west-2:lambda:path/2015-03-31/functions/arn:aws:lambda:us-west-2:762537114155:function:getUntaggedASGs/invocations",
            "kms_key_arn": "",
            "last_modified": "2019-08-15T20:05:51.170+0000",
            "layers": null,
            "memory_size": 128,
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-west-2:762537114155:function:getUntaggedASGs:$LATEST",
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::762537114155:role/lambda_read_instances",
            "runtime": "python3.6",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "source_code_hash": "ew0jI7JWgaZVdaCpff/6WMzBwCBPQm1r6tsHrc2bizM=",
            "source_code_size": 1409,
            "tags": null,
            "timeout": 120,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9fQ==",
          "depends_on": [
            "aws_iam_role.lambda_read_instances"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "getUntaggedInstances",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lambda:us-west-2:762537114155:function:getUntaggedInstances",
            "dead_letter_config": [],
            "description": "Gathers a list of untagged or improperly tagged instances.",
            "environment": [
              {
                "variables": {
                  "REQTAGS": "TTL,owner"
                }
              }
            ],
            "filename": "./files/getUntaggedInstances.zip",
            "function_name": "getUntaggedInstances",
            "handler": "getUntaggedInstances.lambda_handler",
            "id": "getUntaggedInstances",
            "invoke_arn": "arn:aws:apigateway:us-west-2:lambda:path/2015-03-31/functions/arn:aws:lambda:us-west-2:762537114155:function:getUntaggedInstances/invocations",
            "kms_key_arn": "",
            "last_modified": "2019-08-15T20:05:41.690+0000",
            "layers": null,
            "memory_size": 128,
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-west-2:762537114155:function:getUntaggedInstances:$LATEST",
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::762537114155:role/lambda_read_instances",
            "runtime": "python3.6",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "source_code_hash": "vfsMKCTD10JuVmRy2YOb8D/HoIT0LG8q9sEU66S0QH8=",
            "source_code_size": 1489,
            "tags": null,
            "timeout": 120,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9fQ==",
          "depends_on": [
            "aws_iam_role.lambda_read_instances"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "notifyInstanceUsage",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lambda:us-west-2:762537114155:function:notifyInstanceUsage",
            "dead_letter_config": [],
            "description": "Sends a notification message with info about number of running instances by type.",
            "environment": [
              {
                "variables": {
                  "slackChannel": "#aws-test",
                  "slackHookUrl": "https://hooks.slack.com/services/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"
                }
              }
            ],
            "filename": "./files/notifyInstanceUsage.zip",
            "function_name": "notifyInstanceUsage",
            "handler": "notifyInstanceUsage.lambda_handler",
            "id": "notifyInstanceUsage",
            "invoke_arn": "arn:aws:apigateway:us-west-2:lambda:path/2015-03-31/functions/arn:aws:lambda:us-west-2:762537114155:function:notifyInstanceUsage/invocations",
            "kms_key_arn": "",
            "last_modified": "2019-08-15T20:05:34.782+0000",
            "layers": null,
            "memory_size": 128,
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-west-2:762537114155:function:notifyInstanceUsage:$LATEST",
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::762537114155:role/lambda_notify",
            "runtime": "python3.6",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "source_code_hash": "0wmIor0YdvvpCTvVVUE9ShV6DPYFTRkXVXFU/bpi2BI=",
            "source_code_size": 2496,
            "tags": null,
            "timeout": 120,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9fQ==",
          "depends_on": [
            "aws_iam_role.lambda_notify"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "notifyUntaggedInstances",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lambda:us-west-2:762537114155:function:notifyUntaggedInstances",
            "dead_letter_config": [],
            "description": "Sends a notification message with info about untagged instances.",
            "environment": [
              {
                "variables": {
                  "slackChannel": "#aws-test",
                  "slackHookUrl": "https://hooks.slack.com/services/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"
                }
              }
            ],
            "filename": "./files/notifyUntaggedInstances.zip",
            "function_name": "notifyUntaggedInstances",
            "handler": "notifyUntaggedInstances.lambda_handler",
            "id": "notifyUntaggedInstances",
            "invoke_arn": "arn:aws:apigateway:us-west-2:lambda:path/2015-03-31/functions/arn:aws:lambda:us-west-2:762537114155:function:notifyUntaggedInstances/invocations",
            "kms_key_arn": "",
            "last_modified": "2019-08-15T20:05:32.392+0000",
            "layers": null,
            "memory_size": 128,
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-west-2:762537114155:function:notifyUntaggedInstances:$LATEST",
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::762537114155:role/lambda_notify",
            "runtime": "python3.6",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "source_code_hash": "UxpctD0U4eTy0zkWbrIz/gxzqgnalULhw8huYdo8/OA=",
            "source_code_size": 2600,
            "tags": null,
            "timeout": 120,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9fQ==",
          "depends_on": [
            "aws_iam_role.lambda_notify"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_permission",
      "name": "allow_cloudwatch_check_ttls",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "action": "lambda:InvokeFunction",
            "event_source_token": null,
            "function_name": "EC2Reaper",
            "id": "AllowExecutionFromCloudWatch",
            "principal": "events.amazonaws.com",
            "qualifier": "",
            "source_account": null,
            "source_arn": "arn:aws:events:us-west-2:762537114155:rule/check_instance_ttls",
            "statement_id": "AllowExecutionFromCloudWatch",
            "statement_id_prefix": null
          },
          "private": "bnVsbA==",
          "depends_on": [
            "aws_cloudwatch_event_rule.check_instance_ttls",
            "aws_lambda_function.EC2Reaper"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_permission",
      "name": "allow_cloudwatch_clean_untagged_asgs",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "action": "lambda:InvokeFunction",
            "event_source_token": null,
            "function_name": "ASGJanitor",
            "id": "AllowExecutionFromCloudWatch",
            "principal": "events.amazonaws.com",
            "qualifier": "",
            "source_account": null,
            "source_arn": "arn:aws:events:us-west-2:762537114155:rule/clean_untagged_asgs",
            "statement_id": "AllowExecutionFromCloudWatch",
            "statement_id_prefix": null
          },
          "private": "bnVsbA==",
          "depends_on": [
            "aws_cloudwatch_event_rule.clean_untagged_asgs",
            "aws_lambda_function.ASGJanitor"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_permission",
      "name": "allow_cloudwatch_clean_untagged_instances",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "action": "lambda:InvokeFunction",
            "event_source_token": null,
            "function_name": "EC2Janitor",
            "id": "AllowExecutionFromCloudWatch",
            "principal": "events.amazonaws.com",
            "qualifier": "",
            "source_account": null,
            "source_arn": "arn:aws:events:us-west-2:762537114155:rule/clean_untagged_instances",
            "statement_id": "AllowExecutionFromCloudWatch",
            "statement_id_prefix": null
          },
          "private": "bnVsbA==",
          "depends_on": [
            "aws_cloudwatch_event_rule.clean_untagged_instances",
            "aws_lambda_function.EC2Janitor"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_permission",
      "name": "allow_cloudwatch_instance_usage",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "action": "lambda:InvokeFunction",
            "event_source_token": null,
            "function_name": "notifyInstanceUsage",
            "id": "AllowExecutionFromCloudWatch",
            "principal": "events.amazonaws.com",
            "qualifier": "",
            "source_account": null,
            "source_arn": "arn:aws:events:us-west-2:762537114155:rule/notify_running_instances",
            "statement_id": "AllowExecutionFromCloudWatch",
            "statement_id_prefix": null
          },
          "private": "bnVsbA==",
          "depends_on": [
            "aws_cloudwatch_event_rule.notify_running_instances",
            "aws_lambda_function.notifyInstanceUsage"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_permission",
      "name": "allow_cloudwatch_untagged_instances",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "action": "lambda:InvokeFunction",
            "event_source_token": null,
            "function_name": "notifyUntaggedInstances",
            "id": "AllowExecutionFromCloudWatch",
            "principal": "events.amazonaws.com",
            "qualifier": "",
            "source_account": null,
            "source_arn": "arn:aws:events:us-west-2:762537114155:rule/notify_untagged_instances",
            "statement_id": "AllowExecutionFromCloudWatch",
            "statement_id_prefix": null
          },
          "private": "bnVsbA==",
          "depends_on": [
            "aws_cloudwatch_event_rule.notify_untagged_instances",
            "aws_lambda_function.notifyUntaggedInstances"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_permission",
      "name": "asg_allow_cloudwatch_check_ttls",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "action": "lambda:InvokeFunction",
            "event_source_token": null,
            "function_name": "ASGReaper",
            "id": "AllowExecutionFromCloudWatch",
            "principal": "events.amazonaws.com",
            "qualifier": "",
            "source_account": null,
            "source_arn": "arn:aws:events:us-west-2:762537114155:rule/check_asg_ttls",
            "statement_id": "AllowExecutionFromCloudWatch",
            "statement_id_prefix": null
          },
          "private": "bnVsbA==",
          "depends_on": [
            "aws_cloudwatch_event_rule.check_asg_ttls",
            "aws_lambda_function.ASGReaper"
          ]
        }
      ]
    }
  ]
}
